<?xml version="1.0" encoding="utf-8" ?>
<Page
    x:Class="Dorexcel.Pages.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:pages="using:Dorexcel.Pages"
    mc:Ignorable="d">
    <ScrollView HorizontalScrollMode="Disabled" VerticalScrollMode="Auto">
        <Grid
            Width="1440"
            Height="Auto"
            Padding="32,16,32,64"
            HorizontalAlignment="Center"
            ColumnSpacing="16"
            RowSpacing="16">
            <Grid.RowDefinitions>
                <!--  title  -->
                <RowDefinition Height="Auto" />

                <!--  file and sheet  -->
                <RowDefinition Height="Auto" />

                <!--  headers and id  -->
                <RowDefinition Height="Auto" />

                <!--  separator  -->
                <RowDefinition Height="Auto" />

                <!--  subtitle  -->
                <RowDefinition Height="Auto" />

                <!--  id input  -->
                <RowDefinition Height="Auto" />

                <!--  inputs grid  -->
                <RowDefinition Height="*" />

                <!--  save button  -->
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!--  title  -->
            <StackPanel
                Grid.Row="0"
                Grid.Column="0"
                Grid.ColumnSpan="4"
                Margin="0,0,0,16"
                VerticalAlignment="Center"
                Orientation="Horizontal"
                Spacing="8">
                <FontIcon
                    Margin="0,6,0,0"
                    FontFamily="Segoe Fluent Icons"
                    FontSize="28"
                    Glyph="&#xECA5;" />
                <TextBlock
                    FontSize="32"
                    FontWeight="ExtraBold"
                    Text="DOREXCEL" />
            </StackPanel>


            <!--  file and sheet  -->
            <Button
                Grid.Row="1"
                Grid.Column="0"
                Grid.ColumnSpan="2"
                Margin="0,0,0,2"
                VerticalAlignment="Bottom"
                Background="Green"
                Click="OnOpenSpreadsheetButtonClick"
                Foreground="WhiteSmoke"
                Visibility="{x:Bind ViewModel.IsDocumentLoaded, Mode=OneWay, Converter={StaticResource NotBoolToVisibility}}">
                <StackPanel
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="8">
                    <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE8E5;" />
                    <TextBlock Text="Abrir documento de cálculo" />
                </StackPanel>
            </Button>

            <TextBlock
                Grid.Row="1"
                Grid.Column="0"
                Grid.ColumnSpan="2"
                Text="{x:Bind ViewModel.DocumentFilepath, Mode=OneWay}"
                Visibility="{x:Bind ViewModel.IsDocumentLoaded, Mode=OneWay, Converter={StaticResource BoolToVisibility}}" />

            <ComboBox
                Grid.Row="1"
                Grid.Column="2"
                Grid.ColumnSpan="2"
                HorizontalAlignment="Stretch"
                Header="Hoja de cálculo"
                IsEnabled="{x:Bind ViewModel.IsDocumentLoaded, Mode=OneWay}"
                ItemsSource="{x:Bind ViewModel.Sheets, Mode=OneWay}"
                PlaceholderText="Seleccione una hoja de cálculo"
                SelectedItem="{x:Bind ViewModel.SelectedSheet, Mode=TwoWay}" />

            <!--  headers and id  -->
            <NumberBox
                Grid.Row="2"
                Grid.Column="0"
                HorizontalAlignment="Stretch"
                Header="Número de fila de encabezados"
                IsEnabled="{x:Bind ViewModel.IsSheetSelected, Mode=OneWay}"
                Value="{x:Bind ViewModel.HeaderRowNumber, Mode=TwoWay}" />

            <Button
                Grid.Row="2"
                Grid.Column="1"
                VerticalAlignment="Bottom"
                Background="Green"
                Click="OnDefineHeaderRowNumberButtonClick"
                Foreground="WhiteSmoke"
                IsEnabled="{x:Bind ViewModel.IsSheetSelected, Mode=OneWay}">
                <StackPanel
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="8">
                    <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE73E;" />
                    <TextBlock Text="Definir fila de encabezados" />
                </StackPanel>
            </Button>

            <ComboBox
                Grid.Row="2"
                Grid.Column="2"
                Grid.ColumnSpan="2"
                HorizontalAlignment="Stretch"
                Header="Columna de identidad"
                IsEnabled="{x:Bind ViewModel.IsHeaderRowNumberValid, Mode=OneWay}"
                ItemsSource="{x:Bind ViewModel.Columns, Mode=OneWay}"
                PlaceholderText="Seleccione la columna de identidad"
                SelectedItem="{x:Bind ViewModel.SelectedIdColumn, Mode=TwoWay}" />

            <!--  separator  -->
            <NavigationViewItemSeparator
                Grid.Row="3"
                Grid.Column="0"
                Grid.ColumnSpan="4"
                Margin="0,8,0,0" />

            <!--  subtitle  -->
            <TextBlock
                Grid.Row="4"
                Grid.Column="0"
                Grid.ColumnSpan="4"
                Margin="0,0,0,8"
                FontSize="24"
                FontWeight="Bold"
                Opacity="{x:Bind ViewModel.IsIdColumnSelected, Mode=OneWay, Converter={StaticResource BoolToOpacity}}"
                Text="{x:Bind ViewModel.SelectedSheet, Mode=OneWay}" />

            <!--  id input  -->
            <AutoSuggestBox
                x:Name="IdColumnTextBox"
                Grid.Row="5"
                Grid.Column="0"
                Margin="0,0,0,12"
                Header="{x:Bind ViewModel.SelectedIdColumn, Mode=OneWay}"
                Opacity="{x:Bind ViewModel.IsIdColumnSelected, Mode=OneWay, Converter={StaticResource BoolToOpacity}}"
                PlaceholderText="{x:Bind ViewModel.SelectedIdColumn, Mode=OneWay, Converter={StaticResource EnterColumn}}"
                PreviewKeyDown="OnIdColumnTextBoxPreviewKeyDown"
                QuerySubmitted="OnIdColumnQuerySubmitted"
                SuggestionChosen="OnAutoSuggestBoxSuggestionChosen"
                TextChanged="OnAutoSuggestBoxTextChanged" />

            <Button
                Grid.Row="5"
                Grid.Column="1"
                Margin="0,15,0,0"
                Background="Green"
                Click="OnSearchButtonClick"
                Foreground="WhiteSmoke"
                Opacity="{x:Bind ViewModel.IsIdColumnSelected, Mode=OneWay, Converter={StaticResource BoolToOpacity}}">
                <StackPanel
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="8">
                    <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE721;" />
                    <TextBlock Text="Buscar" />
                </StackPanel>
            </Button>

            <!--  inputs grid  -->
            <ItemsRepeater
                x:Name="FieldsRepeater"
                Grid.Row="6"
                Grid.Column="0"
                Grid.ColumnSpan="4"
                ItemsSource="{x:Bind ViewModel.NonIdColumns, Mode=OneWay}"
                Opacity="{x:Bind ViewModel.IsIdColumnSelected, Mode=OneWay, Converter={StaticResource BoolToOpacity}}">
                <ItemsRepeater.Layout>
                    <UniformGridLayout
                        ItemsJustification="Start"
                        ItemsStretch="Fill"
                        MinColumnSpacing="8"
                        MinRowSpacing="16" />
                </ItemsRepeater.Layout>
                <ItemsRepeater.ItemTemplate>
                    <DataTemplate x:DataType="x:String">
                        <AutoSuggestBox
                            Width="336"
                            Header="{Binding}"
                            SuggestionChosen="OnAutoSuggestBoxSuggestionChosen"
                            TextChanged="OnAutoSuggestBoxTextChanged" />
                    </DataTemplate>
                </ItemsRepeater.ItemTemplate>
            </ItemsRepeater>

            <!--  save button  -->
            <Button
                Grid.Row="7"
                Grid.Column="3"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Bottom"
                Background="Green"
                Click="OnSaveButtonClick"
                Foreground="WhiteSmoke"
                Opacity="{x:Bind ViewModel.IsIdColumnSelected, Mode=OneWay, Converter={StaticResource BoolToOpacity}}">
                <StackPanel
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="8">
                    <FontIcon FontFamily="Segoe Fluent Icons" Glyph="&#xE74E;" />
                    <TextBlock Text="Guardar" />
                </StackPanel>
            </Button>
        </Grid>
    </ScrollView>
</Page>
